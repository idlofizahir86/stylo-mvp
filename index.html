<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stylo MVP - Your Style On You</title>
  
  <!-- TensorFlow.js Loading - SIMPLIFIED VERSION -->
  <script>
    // Global state untuk TensorFlow
    window.tensorflowState = {
      loading: false,
      loaded: false,
      error: null,
      poseDetection: null
    };

    async function loadTensorFlow() {
      if (window.tensorflowState.loading || window.tensorflowState.loaded) {
        return;
      }

      window.tensorflowState.loading = true;
      console.log('ðŸš€ Loading TensorFlow.js...');

      try {
        // Load TensorFlow.js core
        await loadScript('https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0/dist/tf.min.js');
        console.log('âœ… TensorFlow.js loaded');
        
        // Load Pose Detection
        await loadScript('https://cdn.jsdelivr.net/npm/@tensorflow-models/pose-detection@2.1.3/dist/pose-detection.min.js');
        console.log('âœ… Pose Detection loaded');
        
        // Setup TensorFlow
        await tf.setBackend('webgl').catch(() => tf.setBackend('cpu'));
        await tf.ready();
        
        // Set global variables
        window.tf = tf;
        window.PoseDetection = poseDetection;
        window.tensorflowState.loaded = true;
        window.tensorflowState.poseDetection = poseDetection;
        
        console.log('ðŸŽ‰ TensorFlow.js ready! Backend:', tf.getBackend());
        console.log('PoseDetection available:', !!window.PoseDetection);
        
        // Dispatch event
        window.dispatchEvent(new CustomEvent('tensorflow-loaded'));
        
      } catch (error) {
        console.error('âŒ TensorFlow.js loading failed:', error);
        window.tensorflowState.error = error.message;
        window.dispatchEvent(new CustomEvent('tensorflow-error', { 
          detail: { message: error.message } 
        }));
      } finally {
        window.tensorflowState.loading = false;
      }
    }

    function loadScript(src) {
      return new Promise((resolve, reject) => {
        const script = document.createElement('script');
        script.src = src;
        script.crossOrigin = 'anonymous';
        script.onload = () => {
          console.log(`âœ… Script loaded: ${src.split('/').pop()}`);
          resolve();
        };
        script.onerror = (error) => {
          console.error(`âŒ Failed to load: ${src}`, error);
          reject(error);
        };
        document.head.appendChild(script);
      });
    }

    // Start loading TensorFlow.js
    setTimeout(() => {
      loadTensorFlow();
    }, 100);
  </script>
</head>
<body>
  <div id="root"></div>
  <script type="module" src="/src/main.jsx"></script>
</body>
</html>